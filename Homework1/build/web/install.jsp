<%@ page contentType="text/html" pageEncoding="UTF-8" %>
<%@ page import = "java.sql.*" %>

<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title>Database SQL Load</title>
    </head>
    <style>
        .error {
            color: red;
        }
        pre {
            color: green;
        }
    </style>
    <body>
        <h2>Database SQL Load</h2>
        <%
            /* How to customize:
             * 1. Update the database name on dbname.
             * 2. Create the list of tables, under tablenames[].
             * 3. Create the list of table definition, under tables[].
             * 4. Create the data into the above table, under data[]. 
             * 
             * If there is any problem, it will exit at the very first error.
             */
            String dbname = "homework1";
            String schema = "ROOT";
            Class.forName("org.apache.derby.jdbc.ClientDriver");
            /* this will generate database if not exist */
            Connection con = DriverManager.getConnection("jdbc:derby://localhost:1527/" + dbname, "root", "root");
            Statement stmt = con.createStatement();
            
            /* inserting data */
            /* you have to exclude the id autogenerated from the list of columns if you have use it. */
            String data[] = new String[]{
                "INSERT INTO " + schema + ".CREDENTIALS VALUES (NEXT VALUE FOR CREDENTIALS_GEN, 'sob','sob')",
                "INSERT INTO " + schema + ".CREDENTIALS VALUES (NEXT VALUE FOR CREDENTIALS_GEN,'123','pere@gamil.com')",
                "INSERT INTO " + schema + ".CREDENTIALS VALUES (NEXT VALUE FOR CREDENTIALS_GEN,'456','marc@gamil.com')",
                "INSERT INTO " + schema + ".CUSTOMER VALUES (NEXT VALUE FOR CUSTOMER_GEN,'sob','612123564',1)",
                "INSERT INTO " + schema + ".CUSTOMER VALUES (NEXT VALUE FOR CUSTOMER_GEN,'Pere','612124564',2)",
                "INSERT INTO " + schema + ".CRYPTO VALUES (NEXT VALUE FOR CRYPTO_GEN, '2022-10-8-12.00.00.000000','Dogecoin es una criptomoneda derivada de Bitcoin que utiliza un perro Shiba Inu del meme de Internet Doge como mascota. Es una criptomoneda inflacionaria porque no tiene límite de emisión.', 'Dogecoin', 0.068,null)",
                "INSERT INTO " + schema + ".CRYPTO VALUES (NEXT VALUE FOR CRYPTO_GEN, '2022-5-4-04.00.00.000000','Ether (ETH), su criptomoneda nativa, es un token que puede ser utilizado en transacciones que usen este software.', 'Ethereum', 1300,null)",
                "INSERT INTO " + schema + ".CRYPTO VALUES (NEXT VALUE FOR CRYPTO_GEN, '2022-4-9-08.00.00.000000','Bitcoin es una moneda virtual o un medio de intercambio electrónico que sirve para adquirir productos y servicios como cualquier otra moneda.', 'Bitcoin', 16000,null)"
             
            };
            for (String datum : data) {
                if (stmt.executeUpdate(datum)<=0) {
                    out.println("<span class='error'>Error inserting data: " + datum + "</span>");
                    return;
                }
                out.println("<pre> -> " + datum + "<pre>");
            }
        %>
        <button onclick="window.location='<%=request.getSession().getServletContext().getContextPath()%>'">Go home</button>
    </body>
</html>
